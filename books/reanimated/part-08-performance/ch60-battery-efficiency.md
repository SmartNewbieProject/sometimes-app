# Chapter 60: ë°°í„°ë¦¬ íš¨ìœ¨

ëª¨ë°”ì¼ ê¸°ê¸°ì˜ ë°°í„°ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ì„œ ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.

## ğŸ“Œ í•™ìŠµ ëª©í‘œ

- ì• ë‹ˆë©”ì´ì…˜ì´ ë°°í„°ë¦¬ ì†Œëª¨ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì´í•´
- ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœì—ì„œ ì• ë‹ˆë©”ì´ì…˜ ìµœì í™”
- ì ì‘í˜• í”„ë ˆì„ ë ˆì´íŠ¸ êµ¬í˜„
- ì „ë ¥ íš¨ìœ¨ì ì¸ ì• ë‹ˆë©”ì´ì…˜ íŒ¨í„´ ìŠµë“

## ğŸ“– ê°œë… ì´í•´

### ë°°í„°ë¦¬ ì†Œëª¨ ìš”ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Battery Drain Factors                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              GPU ì‚¬ìš©ëŸ‰ (ë†’ìŒ)                       â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ â€¢ ë³µì¡í•œ ê·¸ë˜í”½ ë Œë”ë§                               â”‚    â”‚
â”‚  â”‚ â€¢ ê·¸ë¼ë°ì´ì…˜, ê·¸ë¦¼ì, ë¸”ëŸ¬ íš¨ê³¼                      â”‚    â”‚
â”‚  â”‚ â€¢ í° ì´ë¯¸ì§€ ì²˜ë¦¬                                     â”‚    â”‚
â”‚  â”‚ â€¢ ê³ í•´ìƒë„ ì• ë‹ˆë©”ì´ì…˜                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              CPU ì‚¬ìš©ëŸ‰ (ì¤‘ê°„)                       â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ â€¢ JS Thread ê³„ì‚°                                     â”‚    â”‚
â”‚  â”‚ â€¢ ë³µì¡í•œ ë ˆì´ì•„ì›ƒ ê³„ì‚°                               â”‚    â”‚
â”‚  â”‚ â€¢ ë¹ˆë²ˆí•œ ë¦¬ë Œë”ë§                                    â”‚    â”‚
â”‚  â”‚ â€¢ ë¬´ê±°ìš´ Worklet í•¨ìˆ˜                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              í™”ë©´ ê°±ì‹  ë¹ˆë„ (ë†’ìŒ)                   â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ â€¢ 60fps = ì´ˆë‹¹ 60íšŒ í™”ë©´ ì—…ë°ì´íŠ¸                    â”‚    â”‚
â”‚  â”‚ â€¢ ë¬´í•œ ë°˜ë³µ ì• ë‹ˆë©”ì´ì…˜                               â”‚    â”‚
â”‚  â”‚ â€¢ ë°±ê·¸ë¼ìš´ë“œì—ì„œë„ ì‹¤í–‰ë˜ëŠ” ì• ë‹ˆë©”ì´ì…˜               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì•± ìƒíƒœì™€ ì• ë‹ˆë©”ì´ì…˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  App State Lifecycle                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Active (í¬ê·¸ë¼ìš´ë“œ)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ â€¢ ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ ì •ìƒ ì‹¤í–‰                              â”‚
â”‚  â”‚ â€¢ 60fps ëª©í‘œ                                             â”‚
â”‚  â”‚ â€¢ ì‚¬ìš©ì ì¸í„°ë™ì…˜ ë°˜ì‘                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚  Inactive (ì „í™˜ ì¤‘)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ â€¢ ì•Œë¦¼ ì„¼í„° ì—´ë¦¼                                         â”‚
â”‚  â”‚ â€¢ ì•± ìŠ¤ìœ„ì²˜ í‘œì‹œ                                         â”‚
â”‚  â”‚ â€¢ ì• ë‹ˆë©”ì´ì…˜ ì¼ì‹œ ì •ì§€ ê°€ëŠ¥                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚  Background                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ â€¢ ëª¨ë“  ì‹œê°ì  ì• ë‹ˆë©”ì´ì…˜ ì •ì§€ í•„ìˆ˜                       â”‚
â”‚  â”‚ â€¢ ë¦¬ì†ŒìŠ¤ í•´ì œ                                            â”‚
â”‚  â”‚ â€¢ íƒ€ì´ë¨¸/ì¸í„°ë²Œ ì •ë¦¬                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’» ì½”ë“œ ì˜ˆì œ

### 1. ì•± ìƒíƒœ ê¸°ë°˜ ì• ë‹ˆë©”ì´ì…˜ ì œì–´

```typescript
import React, { useEffect, useCallback, useRef } from 'react';
import { View, StyleSheet, AppState, AppStateStatus } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withRepeat,
  withTiming,
  cancelAnimation,
  withSpring,
} from 'react-native-reanimated';

// ì•± ìƒíƒœ ê¸°ë°˜ ì• ë‹ˆë©”ì´ì…˜ í›…
function useAppStateAnimation<T extends number>(
  initialValue: T,
  options?: {
    pauseOnBackground?: boolean;
    pauseOnInactive?: boolean;
  }
) {
  const { pauseOnBackground = true, pauseOnInactive = false } = options || {};

  const value = useSharedValue(initialValue);
  const savedValue = useRef(initialValue);
  const isAnimating = useRef(false);
  const currentAnimation = useRef<(() => void) | null>(null);

  useEffect(() => {
    const handleAppStateChange = (nextState: AppStateStatus) => {
      const shouldPause =
        (pauseOnBackground && nextState === 'background') ||
        (pauseOnInactive && nextState === 'inactive');

      if (shouldPause && isAnimating.current) {
        // í˜„ì¬ ê°’ ì €ì¥ í›„ ì •ì§€
        savedValue.current = value.value as T;
        cancelAnimation(value);
        isAnimating.current = false;
      } else if (nextState === 'active' && !isAnimating.current) {
        // ë³µì›
        if (currentAnimation.current) {
          currentAnimation.current();
        }
      }
    };

    const subscription = AppState.addEventListener('change', handleAppStateChange);

    return () => {
      subscription.remove();
    };
  }, [pauseOnBackground, pauseOnInactive, value]);

  const animate = useCallback((animation: () => void) => {
    currentAnimation.current = animation;
    isAnimating.current = true;
    animation();
  }, []);

  const stop = useCallback(() => {
    cancelAnimation(value);
    isAnimating.current = false;
    currentAnimation.current = null;
  }, [value]);

  return {
    value,
    animate,
    stop,
    isAnimating: isAnimating.current,
  };
}

// ì‚¬ìš© ì˜ˆì‹œ: ë¡œë”© ìŠ¤í”¼ë„ˆ
function BatteryEfficientSpinner() {
  const { value: rotation, animate, stop } = useAppStateAnimation(0, {
    pauseOnBackground: true,
    pauseOnInactive: true,
  });

  useEffect(() => {
    animate(() => {
      rotation.value = withRepeat(
        withTiming(360, { duration: 1000 }),
        -1,
        false
      );
    });

    return () => stop();
  }, [animate, rotation, stop]);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ rotate: `${rotation.value}deg` }],
  }));

  return (
    <Animated.View style={[styles.spinner, animatedStyle]}>
      <View style={styles.spinnerDot} />
    </Animated.View>
  );
}

const styles = StyleSheet.create({
  spinner: {
    width: 40,
    height: 40,
    justifyContent: 'flex-start',
    alignItems: 'center',
  },
  spinnerDot: {
    width: 8,
    height: 8,
    borderRadius: 4,
    backgroundColor: '#7A4AE2',
  },
});
```

### 2. ê°€ì‹œì„± ê¸°ë°˜ ì• ë‹ˆë©”ì´ì…˜

```typescript
import React, { useCallback, useRef, useEffect } from 'react';
import { View, StyleSheet, Dimensions } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withRepeat,
  withTiming,
  cancelAnimation,
  runOnJS,
} from 'react-native-reanimated';

const { height: SCREEN_HEIGHT } = Dimensions.get('window');

// í™”ë©´ì— ë³´ì¼ ë•Œë§Œ ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
function useVisibilityAnimation() {
  const isVisible = useSharedValue(false);
  const animatedValues = useRef<Animated.SharedValue<number>[]>([]);

  const registerValue = useCallback((value: Animated.SharedValue<number>) => {
    animatedValues.current.push(value);
  }, []);

  const pauseAll = useCallback(() => {
    animatedValues.current.forEach(v => cancelAnimation(v));
  }, []);

  const setVisibility = useCallback((visible: boolean) => {
    isVisible.value = visible;
    if (!visible) {
      pauseAll();
    }
  }, [isVisible, pauseAll]);

  return {
    isVisible,
    setVisibility,
    registerValue,
    pauseAll,
  };
}

// IntersectionObserver ìœ ì‚¬ í›…
function useOnScreen(
  callback: (isVisible: boolean) => void,
  threshold: number = 0.5
) {
  const viewRef = useRef<View>(null);
  const isVisibleRef = useRef(false);

  const checkVisibility = useCallback(() => {
    viewRef.current?.measure((x, y, width, height, pageX, pageY) => {
      const viewTop = pageY;
      const viewBottom = pageY + height;
      const screenTop = 0;
      const screenBottom = SCREEN_HEIGHT;

      const visibleHeight = Math.min(viewBottom, screenBottom) -
                           Math.max(viewTop, screenTop);
      const visibleRatio = Math.max(0, visibleHeight / height);

      const isVisible = visibleRatio >= threshold;

      if (isVisible !== isVisibleRef.current) {
        isVisibleRef.current = isVisible;
        callback(isVisible);
      }
    });
  }, [callback, threshold]);

  return { viewRef, checkVisibility };
}

// í™”ë©´ì— ë³´ì¼ ë•Œë§Œ ì• ë‹ˆë©”ì´ì…˜í•˜ëŠ” ì¹´ë“œ
function VisibilityAwareCard({ index }: { index: number }) {
  const pulse = useSharedValue(1);
  const opacity = useSharedValue(0.5);
  const isAnimating = useRef(false);

  const startAnimation = useCallback(() => {
    if (isAnimating.current) return;
    isAnimating.current = true;

    pulse.value = withRepeat(
      withTiming(1.05, { duration: 1500 }),
      -1,
      true
    );
    opacity.value = withRepeat(
      withTiming(1, { duration: 1500 }),
      -1,
      true
    );
  }, [pulse, opacity]);

  const stopAnimation = useCallback(() => {
    if (!isAnimating.current) return;
    isAnimating.current = false;

    cancelAnimation(pulse);
    cancelAnimation(opacity);
    pulse.value = 1;
    opacity.value = 0.5;
  }, [pulse, opacity]);

  const handleVisibilityChange = useCallback((isVisible: boolean) => {
    if (isVisible) {
      startAnimation();
    } else {
      stopAnimation();
    }
  }, [startAnimation, stopAnimation]);

  const { viewRef, checkVisibility } = useOnScreen(handleVisibilityChange, 0.3);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ scale: pulse.value }],
    opacity: opacity.value,
  }));

  // ì´ˆê¸° ê°€ì‹œì„± ì²´í¬
  useEffect(() => {
    const timer = setTimeout(checkVisibility, 100);
    return () => clearTimeout(timer);
  }, [checkVisibility]);

  return (
    <View ref={viewRef} onLayout={checkVisibility}>
      <Animated.View style={[styles.card, animatedStyle]}>
        {/* ì¹´ë“œ ë‚´ìš© */}
      </Animated.View>
    </View>
  );
}

const styles = StyleSheet.create({
  card: {
    height: 200,
    backgroundColor: '#7A4AE2',
    borderRadius: 16,
    marginVertical: 8,
    marginHorizontal: 16,
  },
});
```

### 3. ì ì‘í˜• í”„ë ˆì„ ë ˆì´íŠ¸

```typescript
import React, { useState, useEffect, useCallback, useRef } from 'react';
import { View, Text, StyleSheet, Platform } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withTiming,
  withSpring,
  Easing,
} from 'react-native-reanimated';
import * as Battery from 'expo-battery'; // Expo ì‚¬ìš© ì‹œ

type QualityLevel = 'high' | 'medium' | 'low';

interface AnimationConfig {
  duration: number;
  useSpring: boolean;
  damping: number;
  stiffness: number;
}

// ë°°í„°ë¦¬ ìƒíƒœ ê¸°ë°˜ í’ˆì§ˆ ì¡°ì ˆ
function useAdaptiveAnimation() {
  const [quality, setQuality] = useState<QualityLevel>('high');
  const [batteryLevel, setBatteryLevel] = useState(1);
  const [isCharging, setIsCharging] = useState(false);

  useEffect(() => {
    let subscription: any;

    const checkBattery = async () => {
      if (Platform.OS === 'web') {
        setQuality('high');
        return;
      }

      try {
        const level = await Battery.getBatteryLevelAsync();
        const state = await Battery.getBatteryStateAsync();

        setBatteryLevel(level);
        setIsCharging(state === Battery.BatteryState.CHARGING);

        // ë°°í„°ë¦¬ ë ˆë²¨ì— ë”°ë¥¸ í’ˆì§ˆ ê²°ì •
        if (state === Battery.BatteryState.CHARGING) {
          setQuality('high');
        } else if (level > 0.5) {
          setQuality('high');
        } else if (level > 0.2) {
          setQuality('medium');
        } else {
          setQuality('low');
        }
      } catch (error) {
        // ë°°í„°ë¦¬ ì •ë³´ ì—†ì„ ì‹œ ê¸°ë³¸ê°’
        setQuality('high');
      }
    };

    checkBattery();

    // ë°°í„°ë¦¬ ìƒíƒœ ë³€í™” êµ¬ë…
    const setupSubscription = async () => {
      subscription = Battery.addBatteryStateListener(({ batteryState }) => {
        checkBattery();
      });
    };

    setupSubscription();

    return () => {
      subscription?.remove();
    };
  }, []);

  const getConfig = useCallback((): AnimationConfig => {
    switch (quality) {
      case 'high':
        return {
          duration: 300,
          useSpring: true,
          damping: 15,
          stiffness: 150,
        };
      case 'medium':
        return {
          duration: 200,
          useSpring: false,
          damping: 20,
          stiffness: 200,
        };
      case 'low':
        return {
          duration: 150,
          useSpring: false,
          damping: 25,
          stiffness: 250,
        };
    }
  }, [quality]);

  const animate = useCallback((
    value: Animated.SharedValue<number>,
    toValue: number
  ) => {
    const config = getConfig();

    if (config.useSpring) {
      value.value = withSpring(toValue, {
        damping: config.damping,
        stiffness: config.stiffness,
      });
    } else {
      value.value = withTiming(toValue, {
        duration: config.duration,
        easing: Easing.out(Easing.quad),
      });
    }
  }, [getConfig]);

  return {
    quality,
    batteryLevel,
    isCharging,
    getConfig,
    animate,
  };
}

// ë°°í„°ë¦¬ ìƒíƒœ í‘œì‹œ ì»´í¬ë„ŒíŠ¸
function BatteryAwareAnimation() {
  const scale = useSharedValue(1);
  const { quality, batteryLevel, isCharging, animate } = useAdaptiveAnimation();

  const handlePress = () => {
    animate(scale, 1.2);
    setTimeout(() => animate(scale, 1), 300);
  };

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ scale: scale.value }],
  }));

  return (
    <View style={styles.container}>
      <View style={styles.statusBar}>
        <Text style={styles.statusText}>
          Battery: {Math.round(batteryLevel * 100)}%
        </Text>
        <Text style={styles.statusText}>
          {isCharging ? 'âš¡ Charging' : 'ğŸ”‹'}
        </Text>
        <View style={[
          styles.qualityBadge,
          {
            backgroundColor:
              quality === 'high' ? '#4CAF50' :
              quality === 'medium' ? '#FFC107' : '#F44336'
          }
        ]}>
          <Text style={styles.qualityText}>
            {quality.toUpperCase()}
          </Text>
        </View>
      </View>

      <Animated.View
        style={[styles.animatedBox, animatedStyle]}
        onTouchEnd={handlePress}
      >
        <Text style={styles.boxText}>Tap Me</Text>
      </Animated.View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 20,
    alignItems: 'center',
  },
  statusBar: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
    marginBottom: 30,
  },
  statusText: {
    fontSize: 14,
    color: '#666',
  },
  qualityBadge: {
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 12,
  },
  qualityText: {
    color: '#FFFFFF',
    fontSize: 12,
    fontWeight: 'bold',
  },
  animatedBox: {
    width: 150,
    height: 150,
    backgroundColor: '#7A4AE2',
    borderRadius: 20,
    justifyContent: 'center',
    alignItems: 'center',
  },
  boxText: {
    color: '#FFFFFF',
    fontSize: 18,
    fontWeight: '600',
  },
});
```

### 4. ì €ì „ë ¥ ëª¨ë“œ ê°ì§€

```typescript
import React, { useState, useEffect, useCallback } from 'react';
import { View, Text, StyleSheet, Platform, NativeModules } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withTiming,
  withSpring,
  withRepeat,
  cancelAnimation,
} from 'react-native-reanimated';

// ì €ì „ë ¥ ëª¨ë“œ ê°ì§€ (iOS)
function useLowPowerMode() {
  const [isLowPowerMode, setIsLowPowerMode] = useState(false);

  useEffect(() => {
    if (Platform.OS !== 'ios') {
      return;
    }

    // Native Module í†µí•´ ì €ì „ë ¥ ëª¨ë“œ ê°ì§€
    // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” Native Module í•„ìš”
    const checkLowPowerMode = async () => {
      try {
        // const lowPower = await NativeModules.LowPowerMode?.isEnabled();
        // setIsLowPowerMode(lowPower ?? false);
        setIsLowPowerMode(false); // ê¸°ë³¸ê°’
      } catch {
        setIsLowPowerMode(false);
      }
    };

    checkLowPowerMode();

    // ì£¼ê¸°ì  ì²´í¬ (ì‹¤ì œë¡œëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì‚¬ìš©)
    const interval = setInterval(checkLowPowerMode, 5000);
    return () => clearInterval(interval);
  }, []);

  return isLowPowerMode;
}

// ì €ì „ë ¥ ëª¨ë“œ ëŒ€ì‘ ì• ë‹ˆë©”ì´ì…˜
function LowPowerAwareComponent() {
  const isLowPowerMode = useLowPowerMode();
  const opacity = useSharedValue(1);
  const translateY = useSharedValue(0);

  useEffect(() => {
    if (isLowPowerMode) {
      // ì €ì „ë ¥ ëª¨ë“œ: ì• ë‹ˆë©”ì´ì…˜ ë‹¨ìˆœí™”
      cancelAnimation(opacity);
      cancelAnimation(translateY);
      opacity.value = 1;
      translateY.value = 0;
    } else {
      // ì¼ë°˜ ëª¨ë“œ: í’€ ì• ë‹ˆë©”ì´ì…˜
      opacity.value = withRepeat(
        withTiming(0.6, { duration: 2000 }),
        -1,
        true
      );
      translateY.value = withRepeat(
        withTiming(-10, { duration: 1500 }),
        -1,
        true
      );
    }

    return () => {
      cancelAnimation(opacity);
      cancelAnimation(translateY);
    };
  }, [isLowPowerMode, opacity, translateY]);

  const animatedStyle = useAnimatedStyle(() => ({
    opacity: opacity.value,
    transform: [{ translateY: translateY.value }],
  }));

  return (
    <View style={styles.container}>
      {isLowPowerMode && (
        <View style={styles.lowPowerBanner}>
          <Text style={styles.lowPowerText}>
            âš¡ Low Power Mode - Animations Simplified
          </Text>
        </View>
      )}

      <Animated.View style={[styles.floatingCard, animatedStyle]}>
        <Text style={styles.cardText}>Floating Card</Text>
      </Animated.View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
  },
  lowPowerBanner: {
    position: 'absolute',
    top: 50,
    left: 20,
    right: 20,
    backgroundColor: '#FFF3CD',
    padding: 12,
    borderRadius: 8,
  },
  lowPowerText: {
    color: '#856404',
    fontSize: 14,
    textAlign: 'center',
  },
  floatingCard: {
    width: 200,
    height: 100,
    backgroundColor: '#7A4AE2',
    borderRadius: 16,
    justifyContent: 'center',
    alignItems: 'center',
    shadowColor: '#7A4AE2',
    shadowOffset: { width: 0, height: 10 },
    shadowOpacity: 0.3,
    shadowRadius: 15,
    elevation: 10,
  },
  cardText: {
    color: '#FFFFFF',
    fontSize: 18,
    fontWeight: '600',
  },
});
```

### 5. íš¨ìœ¨ì ì¸ ë¬´í•œ ì• ë‹ˆë©”ì´ì…˜

```typescript
import React, { useEffect, useCallback, useRef } from 'react';
import { View, StyleSheet, AppState } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withRepeat,
  withTiming,
  withSequence,
  cancelAnimation,
  Easing,
} from 'react-native-reanimated';

// íš¨ìœ¨ì ì¸ ë¬´í•œ ì• ë‹ˆë©”ì´ì…˜ í›…
function useEfficientInfiniteAnimation() {
  const rotation = useSharedValue(0);
  const isRunning = useRef(false);
  const appStateRef = useRef(AppState.currentState);

  const start = useCallback(() => {
    if (isRunning.current) return;
    isRunning.current = true;

    // ì„ í˜• íšŒì „ (Springë³´ë‹¤ íš¨ìœ¨ì )
    rotation.value = 0;
    rotation.value = withRepeat(
      withTiming(360, {
        duration: 2000,
        easing: Easing.linear,
      }),
      -1,
      false
    );
  }, [rotation]);

  const stop = useCallback(() => {
    isRunning.current = false;
    cancelAnimation(rotation);
  }, [rotation]);

  const pause = useCallback(() => {
    cancelAnimation(rotation);
  }, [rotation]);

  const resume = useCallback(() => {
    if (!isRunning.current) return;

    // í˜„ì¬ ê°’ì—ì„œ ì´ì–´ì„œ ì‹œì‘
    const currentRotation = rotation.value % 360;
    rotation.value = currentRotation;
    rotation.value = withRepeat(
      withTiming(currentRotation + 360, {
        duration: 2000 * (1 - currentRotation / 360),
        easing: Easing.linear,
      }),
      -1,
      false
    );
  }, [rotation]);

  // ì•± ìƒíƒœ ë³€í™” ì²˜ë¦¬
  useEffect(() => {
    const subscription = AppState.addEventListener('change', (nextState) => {
      if (
        appStateRef.current.match(/active/) &&
        nextState.match(/inactive|background/)
      ) {
        pause();
      } else if (
        appStateRef.current.match(/inactive|background/) &&
        nextState === 'active'
      ) {
        resume();
      }
      appStateRef.current = nextState;
    });

    return () => {
      subscription.remove();
      stop();
    };
  }, [pause, resume, stop]);

  return { rotation, start, stop, pause, resume };
}

// íš¨ìœ¨ì ì¸ ë¡œë”© ì¸ë””ì¼€ì´í„°
function EfficientLoadingIndicator({ size = 40 }: { size?: number }) {
  const { rotation, start, stop } = useEfficientInfiniteAnimation();

  useEffect(() => {
    start();
    return () => stop();
  }, [start, stop]);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ rotate: `${rotation.value}deg` }],
  }));

  return (
    <Animated.View
      style={[
        styles.loader,
        { width: size, height: size },
        animatedStyle,
      ]}
    >
      <View style={[styles.loaderArc, { borderWidth: size / 10 }]} />
    </Animated.View>
  );
}

// í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ (íš¨ìœ¨ì  ë²„ì „)
function EfficientPulse({ children }: { children: React.ReactNode }) {
  const scale = useSharedValue(1);
  const isRunning = useRef(false);

  useEffect(() => {
    isRunning.current = true;

    // ë‹¨ìˆœí•œ ì‹œí€€ìŠ¤ (Spring ëŒ€ì‹  Timing)
    scale.value = withRepeat(
      withSequence(
        withTiming(1.05, { duration: 1000, easing: Easing.inOut(Easing.ease) }),
        withTiming(1, { duration: 1000, easing: Easing.inOut(Easing.ease) })
      ),
      -1,
      false
    );

    const subscription = AppState.addEventListener('change', (state) => {
      if (state === 'background') {
        cancelAnimation(scale);
        scale.value = 1;
      } else if (state === 'active' && isRunning.current) {
        scale.value = withRepeat(
          withSequence(
            withTiming(1.05, { duration: 1000 }),
            withTiming(1, { duration: 1000 })
          ),
          -1,
          false
        );
      }
    });

    return () => {
      isRunning.current = false;
      cancelAnimation(scale);
      subscription.remove();
    };
  }, [scale]);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ scale: scale.value }],
  }));

  return (
    <Animated.View style={animatedStyle}>
      {children}
    </Animated.View>
  );
}

const styles = StyleSheet.create({
  loader: {
    justifyContent: 'center',
    alignItems: 'center',
  },
  loaderArc: {
    width: '100%',
    height: '100%',
    borderRadius: 1000,
    borderColor: 'transparent',
    borderTopColor: '#7A4AE2',
  },
});

export { EfficientLoadingIndicator, EfficientPulse, useEfficientInfiniteAnimation };
```

## sometimes-app ì ìš© ì‚¬ë¡€

### ë§¤ì¹­ ëŒ€ê¸° í™”ë©´ ë°°í„°ë¦¬ ìµœì í™”

```typescript
// src/features/matching/ui/battery-efficient-matching.tsx
import React, { useEffect, useCallback, useRef, useState } from 'react';
import { View, Text, StyleSheet, AppState, Dimensions } from 'react-native';
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withRepeat,
  withTiming,
  withSequence,
  cancelAnimation,
  Easing,
  interpolate,
  runOnJS,
} from 'react-native-reanimated';

const { width: SCREEN_WIDTH } = Dimensions.get('window');

interface MatchingWaitProps {
  estimatedTime: number; // ì´ˆ
  onMatch: () => void;
}

export function BatteryEfficientMatchingWait({
  estimatedTime,
  onMatch,
}: MatchingWaitProps) {
  const [quality, setQuality] = useState<'high' | 'low'>('high');

  // ì• ë‹ˆë©”ì´ì…˜ ê°’ë“¤
  const heartbeat = useSharedValue(1);
  const ripple1 = useSharedValue(0);
  const ripple2 = useSharedValue(0);
  const ripple3 = useSharedValue(0);
  const progress = useSharedValue(0);

  const isActiveRef = useRef(true);

  // í’ˆì§ˆ ê°ì§€
  useEffect(() => {
    // 3ë¶„ ì´ìƒ ëŒ€ê¸° ì‹œ ì €í’ˆì§ˆ ëª¨ë“œ
    if (estimatedTime > 180) {
      setQuality('low');
    }
  }, [estimatedTime]);

  // ì‹¬ì¥ë°•ë™ ì• ë‹ˆë©”ì´ì…˜
  const startHeartbeat = useCallback(() => {
    if (quality === 'high') {
      heartbeat.value = withRepeat(
        withSequence(
          withTiming(1.1, { duration: 300, easing: Easing.out(Easing.ease) }),
          withTiming(1, { duration: 300, easing: Easing.in(Easing.ease) }),
          withTiming(1.08, { duration: 250, easing: Easing.out(Easing.ease) }),
          withTiming(1, { duration: 650, easing: Easing.in(Easing.ease) })
        ),
        -1,
        false
      );
    } else {
      // ì €í’ˆì§ˆ: ë‹¨ìˆœí•œ í„ìŠ¤
      heartbeat.value = withRepeat(
        withSequence(
          withTiming(1.05, { duration: 1000 }),
          withTiming(1, { duration: 1000 })
        ),
        -1,
        false
      );
    }
  }, [heartbeat, quality]);

  // ë¦¬í”Œ ì• ë‹ˆë©”ì´ì…˜
  const startRipples = useCallback(() => {
    if (quality === 'low') return; // ì €í’ˆì§ˆì—ì„œëŠ” ë¦¬í”Œ ì—†ìŒ

    const createRipple = (value: Animated.SharedValue<number>, delay: number) => {
      setTimeout(() => {
        value.value = 0;
        value.value = withRepeat(
          withTiming(1, { duration: 2500, easing: Easing.out(Easing.ease) }),
          -1,
          false
        );
      }, delay);
    };

    createRipple(ripple1, 0);
    createRipple(ripple2, 800);
    createRipple(ripple3, 1600);
  }, [ripple1, ripple2, ripple3, quality]);

  // ì§„í–‰ë¥  ì• ë‹ˆë©”ì´ì…˜
  const startProgress = useCallback(() => {
    progress.value = 0;
    progress.value = withTiming(1, {
      duration: estimatedTime * 1000,
      easing: Easing.linear,
    });
  }, [progress, estimatedTime]);

  // ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
  const startAllAnimations = useCallback(() => {
    if (!isActiveRef.current) return;
    startHeartbeat();
    startRipples();
    startProgress();
  }, [startHeartbeat, startRipples, startProgress]);

  // ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
  const stopAllAnimations = useCallback(() => {
    cancelAnimation(heartbeat);
    cancelAnimation(ripple1);
    cancelAnimation(ripple2);
    cancelAnimation(ripple3);

    // í”„ë¡œê·¸ë ˆìŠ¤ëŠ” ìœ ì§€ (ì¬ê°œ ì‹œ ì´ì–´ì„œ)
  }, [heartbeat, ripple1, ripple2, ripple3]);

  // ì•± ìƒíƒœ ê´€ë¦¬
  useEffect(() => {
    const subscription = AppState.addEventListener('change', (state) => {
      if (state === 'active') {
        isActiveRef.current = true;
        startAllAnimations();
      } else {
        isActiveRef.current = false;
        stopAllAnimations();
      }
    });

    startAllAnimations();

    return () => {
      stopAllAnimations();
      cancelAnimation(progress);
      subscription.remove();
    };
  }, [startAllAnimations, stopAllAnimations, progress]);

  // ìŠ¤íƒ€ì¼ë“¤
  const heartStyle = useAnimatedStyle(() => ({
    transform: [{ scale: heartbeat.value }],
  }));

  const createRippleStyle = (value: Animated.SharedValue<number>) => {
    return useAnimatedStyle(() => ({
      transform: [{ scale: interpolate(value.value, [0, 1], [1, 2.5]) }],
      opacity: interpolate(value.value, [0, 0.5, 1], [0.6, 0.3, 0]),
    }));
  };

  const ripple1Style = createRippleStyle(ripple1);
  const ripple2Style = createRippleStyle(ripple2);
  const ripple3Style = createRippleStyle(ripple3);

  const progressStyle = useAnimatedStyle(() => ({
    width: `${progress.value * 100}%`,
  }));

  return (
    <View style={styles.container}>
      {/* í’ˆì§ˆ í‘œì‹œ */}
      {quality === 'low' && (
        <View style={styles.lowPowerBadge}>
          <Text style={styles.lowPowerText}>ì ˆì „ ëª¨ë“œ</Text>
        </View>
      )}

      {/* ì¤‘ì•™ ì‹¬ì¥ */}
      <View style={styles.heartContainer}>
        {/* ë¦¬í”Œ (ê³ í’ˆì§ˆì—ì„œë§Œ) */}
        {quality === 'high' && (
          <>
            <Animated.View style={[styles.ripple, ripple1Style]} />
            <Animated.View style={[styles.ripple, ripple2Style]} />
            <Animated.View style={[styles.ripple, ripple3Style]} />
          </>
        )}

        <Animated.View style={[styles.heart, heartStyle]}>
          <Text style={styles.heartEmoji}>ğŸ’œ</Text>
        </Animated.View>
      </View>

      {/* ì§„í–‰ë¥  ë°” */}
      <View style={styles.progressContainer}>
        <Animated.View style={[styles.progressBar, progressStyle]} />
      </View>

      <Text style={styles.waitText}>
        ìƒëŒ€ë°©ì„ ì°¾ê³  ìˆì–´ìš”...
      </Text>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#FFFFFF',
  },
  lowPowerBadge: {
    position: 'absolute',
    top: 50,
    backgroundColor: '#FFF3CD',
    paddingHorizontal: 16,
    paddingVertical: 8,
    borderRadius: 16,
  },
  lowPowerText: {
    color: '#856404',
    fontSize: 12,
    fontWeight: '600',
  },
  heartContainer: {
    width: 150,
    height: 150,
    justifyContent: 'center',
    alignItems: 'center',
  },
  ripple: {
    position: 'absolute',
    width: 100,
    height: 100,
    borderRadius: 50,
    backgroundColor: '#E2D5FF',
  },
  heart: {
    width: 80,
    height: 80,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#7A4AE2',
    borderRadius: 40,
  },
  heartEmoji: {
    fontSize: 40,
  },
  progressContainer: {
    width: SCREEN_WIDTH * 0.6,
    height: 4,
    backgroundColor: '#F0F0F0',
    borderRadius: 2,
    marginTop: 40,
    overflow: 'hidden',
  },
  progressBar: {
    height: '100%',
    backgroundColor: '#7A4AE2',
    borderRadius: 2,
  },
  waitText: {
    marginTop: 20,
    fontSize: 16,
    color: '#666',
  },
});
```

## âš ï¸ í”í•œ ì‹¤ìˆ˜ì™€ í•´ê²°ë²•

### 1. ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë¬´í•œ ë£¨í”„

```typescript
// âŒ ë°±ê·¸ë¼ìš´ë“œì—ì„œë„ ê³„ì† ì‹¤í–‰
useEffect(() => {
  rotation.value = withRepeat(withTiming(360), -1);
}, []);

// âœ… ì•± ìƒíƒœ í™•ì¸
useEffect(() => {
  const subscription = AppState.addEventListener('change', (state) => {
    if (state !== 'active') {
      cancelAnimation(rotation);
    } else {
      rotation.value = withRepeat(withTiming(360), -1);
    }
  });

  rotation.value = withRepeat(withTiming(360), -1);

  return () => {
    cancelAnimation(rotation);
    subscription.remove();
  };
}, []);
```

### 2. ë¶ˆí•„ìš”í•œ Spring ì‚¬ìš©

```typescript
// âŒ ë‹¨ìˆœ íšŒì „ì— Spring (ì˜¤ë²„í—¤ë“œ)
rotation.value = withRepeat(
  withSpring(360), // ë¶ˆí•„ìš”í•œ ë¬¼ë¦¬ ê³„ì‚°
  -1
);

// âœ… ì„ í˜• Timing ì‚¬ìš©
rotation.value = withRepeat(
  withTiming(360, { easing: Easing.linear }),
  -1
);
```

### 3. ë‹¤ì¤‘ ë¦¬ìŠ¤ë„ˆ ë“±ë¡

```typescript
// âŒ ë§¤ ë Œë”ë§ˆë‹¤ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
AppState.addEventListener('change', handleChange);

// âœ… useEffectë¡œ ì •ë¦¬
useEffect(() => {
  const subscription = AppState.addEventListener('change', handleChange);
  return () => subscription.remove();
}, []);
```

## ğŸ’¡ ì„±ëŠ¥ ìµœì í™” íŒ

### 1. ì• ë‹ˆë©”ì´ì…˜ ë³µì¡ë„ ë‹¨ê³„

```typescript
const animationComplexity = {
  high: {
    useSpring: true,
    rippleCount: 3,
    shadowEnabled: true,
  },
  medium: {
    useSpring: false,
    rippleCount: 1,
    shadowEnabled: false,
  },
  low: {
    useSpring: false,
    rippleCount: 0,
    shadowEnabled: false,
  },
};
```

### 2. ì§€ì—° ì‹œì‘

```typescript
// í™”ë©´ ì§„ì… í›„ ì•½ê°„ì˜ ì§€ì—° í›„ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
useEffect(() => {
  const timer = setTimeout(() => {
    startAnimation();
  }, 300); // ë ˆì´ì•„ì›ƒ ì™„ë£Œ í›„

  return () => clearTimeout(timer);
}, []);
```

### 3. ë°°ì¹˜ ì—…ë°ì´íŠ¸

```typescript
// ì—¬ëŸ¬ ê°’ì„ í•œ ë²ˆì— ì—…ë°ì´íŠ¸
const stopAll = () => {
  cancelAnimation(value1);
  cancelAnimation(value2);
  cancelAnimation(value3);
  value1.value = 0;
  value2.value = 0;
  value3.value = 0;
};
```

## ğŸ“š ì´ ì¥ì—ì„œ ë°°ìš´ ë‚´ìš©

1. **ë°°í„°ë¦¬ ì†Œëª¨ ìš”ì¸**: GPU, CPU, í™”ë©´ ê°±ì‹  ë¹ˆë„ì˜ ì˜í–¥
2. **ì•± ìƒíƒœ ê´€ë¦¬**: Active, Inactive, Background ìƒíƒœ ì²˜ë¦¬
3. **ê°€ì‹œì„± ê¸°ë°˜ ì œì–´**: í™”ë©´ì— ë³´ì¼ ë•Œë§Œ ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
4. **ì ì‘í˜• í’ˆì§ˆ**: ë°°í„°ë¦¬ ìƒíƒœì— ë”°ë¥¸ ì• ë‹ˆë©”ì´ì…˜ í’ˆì§ˆ ì¡°ì ˆ
5. **ì €ì „ë ¥ ëª¨ë“œ**: ì‹œìŠ¤í…œ ì €ì „ë ¥ ëª¨ë“œ ê°ì§€ ë° ëŒ€ì‘
6. **íš¨ìœ¨ì  íŒ¨í„´**: Spring ëŒ€ì‹  Timing, ë‹¨ìˆœí•œ Easing ì‚¬ìš©

## ë‹¤ìŒ ì¥ ì˜ˆê³ 

**Chapter 61: ì €ì‚¬ì–‘ ê¸°ê¸° ëŒ€ì‘**ì—ì„œëŠ” ë‹¤ì–‘í•œ ì„±ëŠ¥ì˜ ê¸°ê¸°ì—ì„œ ì¼ê´€ëœ ì• ë‹ˆë©”ì´ì…˜ ê²½í—˜ì„ ì œê³µí•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤. ê¸°ê¸° ì„±ëŠ¥ ê°ì§€, ì ì§„ì  ê¸°ëŠ¥ ì €í•˜, í´ë°± ì• ë‹ˆë©”ì´ì…˜ ì „ëµì„ ë‹¤ë£¹ë‹ˆë‹¤.
